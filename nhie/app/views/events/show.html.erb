<!-- Page is in a large if statement that will only show the event page if you are friends with that user. If you aren't friends with that user then it says 404 not found. -->
<% if @friends_events = current_user.friends.map(&:created_events).flatten.include?(@event) || current_user.created_events.flatten.include?(@event) %>

<div class="event-header">
  <h3 class="event-title"><%= @event.event_name %></h3>
  <div class="byline">by <%= @event.creator.first_name %></div>
</div>

<div class="event-section">
  <div class="event-label">description</div>
  <div class="event-info">
    <p><%= @event.description %></p>
  </div>
</div>

<div class="event-section">
  <div class="event-label">time</div>
  <div class="event-info">
    <p><%= @event.event_datetime.strftime("%d %b. %Y %H:%M") %></p>
  </div>
</div>

<div class="event-section">
  <div class="event-label">location</div>
  <div class="event-info">
    <p><%= @event.location %></p>
  </div>
</div>

<div class="event-section">
  <div class="event-info">
    <%= link_to "website", "http://#{@event.url}" %>
  </div>
</div>
    
<!-- If the user created the event, show the delete button, or else if the user isnt participating in the event show the join button, or if they are show the you are attending note -->
<% if @event.creator == current_user %> 
<%= button_to "Delete Event", event_path(@event), {method: :delete, class: 'btn btn-default thin form-control event-button event-action'} %>
<% elsif %>
<% if !current_user.participated_events.include?(@event) %>
<%= button_to "Join Event", event_join_path(@event), method: :post, class: 'btn btn-default thin form-control event-button event-action'  %>
<% elsif %>
<h3 class="event-attendance"> You are attending this event!</h3>
<% end %>
<% end %>


<!-- ++++++++++Conversation Portion++++++++++ -->
<% if current_user %>
<div id="event-list">
 <%= render @event.messages %>
</div>
<% end %>
<br>


<!-- ++++++++++++++++++++++++++++++++++++++++ -->
<%= form_for([@event, @message], remote: true) do |f| %>
<div id="message-errors">
  <% if @message.errors.any? %>
  <%= render partial: 'message/message_form_errors' %>
  <% end %>
</div>

<div class="field">
  <%= f.text_area :body %>
</div>

<div class="actions">
  <%= f.submit class: 'btn btn-default thin form-control event-button'%>
</div>
<% end %>

<% else %>
<h1>404, page not found</h1>
<% end %>